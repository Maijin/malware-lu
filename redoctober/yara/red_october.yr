/* the first rules matches the file on drive and the second rules matches the memory (volatility) */
/* We do not have enough samples to validate that the rules are enough generic */
/* Malware.lu */

rule red_packer
{
   strings:
       $second_sub = { 55 8B EC E8 ?? E0 00 00 33 C0 5D C2 04 00 CC CC 55 8B EC 68 ?? ?? ?? ?? E8 E3 FF FF FF 50 68 60 11 40 00 E8 ?? ?? 00 00 83 C4 08 33 C0 5D C3 CC 55 8B EC E8 D8 FF FF FF 33 C0 5D C2 10 00 CC CC }
   condition:
       $second_sub
}

rule red_memory
{
   strings:
      $str = { 56 8B C3 57 8D 70 01 8A 10 83 C0 01 84 D2 75 F7 2B C6 83 C0 01 BA FC FF  FF FF 2B D0 01 94 24 20 01 00 00 8D 6C 01 04 8B  01 83 F8 03 0F 87 46 01 00 00 FF 24 85 88 13 00  10 8D 54 24 10 8B C3 2B }
   condition:
      $str
}
